(this["webpackJsonpproject6-react"]=this["webpackJsonpproject6-react"]||[]).push([[0],{27:function(e,t,n){e.exports=n(40)},32:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),i=n(11),a=n.n(i),s=(n(32),n(33),n(26)),c=n(6),l=n(7),p=n(9),u=n(8),h=n(10),f=n(17),d=n(15);function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var m={cursor:"pointer",stroke:"none"},O=function(e){function t(){return Object(c.a)(this,t),Object(p.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props,t=e.size,n=void 0===t?20:t,o=e.onClick;return r.a.createElement("svg",{height:n,viewBox:"0 0 24 24",style:g({},m),onClick:o},r.a.createElement("circle",{cx:n/2,cy:n/2,r:n/2,stroke:"none",fill:"".concat(this.props.positive?"rgba(72, 175, 8, 0.5)":"rgba(255, 0, 0, 0.5)")}))}}]),t}(o.PureComponent),v=function(e){function t(){return Object(c.a)(this,t),Object(p.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.props.info;return r.a.createElement("div",null,e.type)}}]),t}(o.PureComponent),y=function(e){function t(){var e,n;Object(c.a)(this,t);for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];return(n=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(i)))).state={viewport:{width:"100%",height:"100%",latitude:49.989698,longitude:36.221784,zoom:15},popupInfo:null},n._onViewportChange=function(e){return n.setState({viewport:e})},n.markerClick=function(e){n.setState({popupInfo:e})},n._renderMarker=function(e,t){return r.a.createElement(f.a,{key:e.id,latitude:e.coordinates[0],longitude:e.coordinates[1]},r.a.createElement(O,{size:20,positive:e.positive,onClick:function(){return n.markerClick(e)}}))},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"_renderPopup",value:function(){var e=this,t=this.state.popupInfo;return t&&r.a.createElement(f.b,{tipSize:5,anchor:"top",latitude:t.coordinates[0],longitude:t.coordinates[1],closeOnClick:!0,onClose:function(){return e.setState({popupInfo:null})}},r.a.createElement(v,{info:t}))}},{key:"render",value:function(){var e=this;return r.a.createElement(f.c,Object.assign({mapboxApiAccessToken:"pk.eyJ1Ijoicm9tYW5ib3JvZGF0b3YiLCJhIjoiY2sxa2w3N3Y1MDdvZjNibzNveXFidWpuaSJ9.h9858JVC3HbU02hxED68eg"},this.state.viewport,{mapStyle:"mapbox://styles/mapbox/streets-v11",onViewportChange:this._onViewportChange}),this.props.points.map((function(t){return e._renderMarker(t)})),this._renderPopup())}}]),t}(o.Component),j=(n(37),function(e){function t(){return Object(c.a)(this,t),Object(p.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"reportButton ".concat(this.props.position),onClick:this.props.clickHandler,style:{backgroundColor:this.props.color}},this.props.filterIcon?r.a.createElement("span",null,"\u25bc"):r.a.createElement("span",null,"+"))}}]),t}(o.Component)),P=n(25);n(38);function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}var E={container:function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(n,!0).forEach((function(t){Object(d.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e,{width:"100%"})}},w=function(e){function t(){var e,n;Object(c.a)(this,t);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={selectedProblemValue:null,error:"",locating:!1},n.handleSelect=function(e){n.setState({selectedProblemValue:e.value})},n.error=function(){n.setState({error:"Unable to retrieve your location"})},n.success=function(e){var t=e.coords.latitude,o=e.coords.longitude,r=n.state.selectedProblemValue,i=localStorage.getItem("userId")&&void 0!==localStorage.getItem("userId")?localStorage.getItem("userId"):null;fetch("https://neolabs-api.zpoken.ai/problems",{method:"POST",headers:{"Content-Type":"application/json",userId:i},body:JSON.stringify({lng:o,lat:t,type:parseInt(r)})}).then((function(e){return e.json()})).then((function(e){localStorage.setItem("userId",e.userId),n.setState({locating:!1}),n.props.getMapPoints(-1),n.props.handleClose()}))},n.handleSubmit=function(){if(n.props.isFilter){var e=n.state.selectedProblemValue;return console.log("problem",e),n.props.getMapPoints(e),void n.props.handleClose()}navigator.geolocation?(n.setState({locating:!0}),navigator.geolocation.getCurrentPosition(n.success,n.error)):n.setState({error:"Geolocation is not supported by your browser"})},n.getOptions=function(){return n.props.options.map((function(e){return{value:e.id,label:e.text}}))},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"report ".concat(this.props.active?"active":"")},r.a.createElement("div",{className:"close-button",onClick:this.props.handleClose},r.a.createElement("span",null,"x")),r.a.createElement("h3",null,this.props.text),r.a.createElement(P.a,{styles:E,options:this.getOptions(),onChange:this.handleSelect}),r.a.createElement("button",{className:"button",onClick:this.handleSubmit,disabled:!this.state.selectedProblemValue},r.a.createElement("span",null,this.props.isFilter?"\u0424\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c":"\u041e\u0442\u043f\u0440\u0430\u0432\u0438\u0442\u044c")))}}]),t}(o.Component),C=n(24),S=(n(39),Object(C.a)({version:8,sources:{points:{type:"geojson",data:{type:"FeatureCollection",features:[{type:"Feature",geometry:{type:"Point",coordinates:[-122.45,37.78]}}]}}},layers:[{id:"my-layer",type:"circle",source:"points",paint:{"circle-color":"#f00","circle-radius":4}}]})),I=function(e){function t(){var e,n;Object(c.a)(this,t);for(var o=arguments.length,r=new Array(o),i=0;i<o;i++)r[i]=arguments[i];return(n=Object(p.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(r)))).state={reportOpened:!1,filterOpened:!1,problemOptions:[],positiveOptions:[],filterOptions:[],loadingPoints:!0,points:[],reportProblem:"bad"},n.getProblemTypes=function(){fetch("https://neolabs-api.zpoken.ai/problems/types",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(e){console.log(e);var t=e.filter((function(e){return!1===e.positive})),o=e.filter((function(e){return!0===e.positive})),r=[{id:-1,text:"\u0412\u0441\u0435"}].concat(Object(s.a)(e));n.setState({problemOptions:t,positiveOptions:o,filterOptions:r})}))},n.getMapPoints=function(e){fetch("https://neolabs-api.zpoken.ai/problems",{method:"GET",headers:{"Content-Type":"application/json"}}).then((function(e){return e.json()})).then((function(t){console.log("filter",e);var o=[];o=-1===e?t:t.filter((function(t){return t.typeId===e})),n.setState({points:o,loadingPoints:!1})}))},n.toggleReport=function(e){console.log("togle"),n.setState({reportOpened:!n.state.reportOpened,reportProblem:e})},n.toggleFilter=function(){console.log("toggleFilter"),n.setState({filterOpened:!n.state.filterOpened})},n}return Object(h.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.getMapPoints(-1),this.getProblemTypes()}},{key:"render",value:function(){var e=this;return this.state.loadingPoints?null:r.a.createElement("div",{className:"App"},r.a.createElement(y,{points:this.state.points,mapStyle:S}),r.a.createElement(j,{clickHandler:function(){return e.toggleReport("good")},color:"green",position:"left"}),r.a.createElement(j,{clickHandler:function(){return e.toggleReport("bad")},color:"red",position:"right"}),r.a.createElement(j,{clickHandler:function(){return e.toggleFilter()},color:"#ff9800",position:"top",filterIcon:!0}),this.state.filterOpened?r.a.createElement(w,{active:this.state.filterOpened,options:this.state.filterOptions,handleClose:this.toggleFilter,getMapPoints:this.getMapPoints,isFilter:!0,text:"\u0424\u0438\u043b\u044c\u0442\u0440"}):"bad"===this.state.reportProblem?r.a.createElement(w,{active:this.state.reportOpened,options:this.state.problemOptions,handleClose:this.toggleReport,getMapPoints:this.getMapPoints,isFilter:!1,text:"\u041e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443"}):r.a.createElement(w,{active:this.state.reportOpened,options:this.state.positiveOptions,handleClose:this.toggleReport,getMapPoints:this.getMapPoints,isFilter:!1,text:"\u041e\u0442\u043c\u0435\u0442\u0438\u0442\u044c \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u0443"}))}}]),t}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[27,1,2]]]);
//# sourceMappingURL=main.b709152c.chunk.js.map